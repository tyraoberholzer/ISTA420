.headers on

-- Name: Tyra Oberholzer
-- File: lab02c-tyra.sql
-- Date: July 15, 2020


-- 1. List the employee IDs with the number of sales by each employee from most sales to least. I want to 
-- recognize the employees with the most sales.

select employeeid, count(orderid) as order_count from orders group by employeeid order by count(orderid) desc limit 1;
EmployeeID|order_count
4|156



-- 2. I want to look at the average discounts taken by all customers for products that cost more than $50.00.
-- Specifically, I want to know the average discount of all orders for each product from the highest price
-- to the lowest price.

select productid, unitprice, avg(discount) as avg_discount from order_details where unitprice > 50 group by productid, unitprice order by productid, unitprice desc, avg_discount desc;
ProductID|UnitPrice|avg_discount
9|97.0|0.1
9|77.6|0.1
18|62.5|0.0857142857142857
20|81.0|0.04
20|64.8|0.06
29|123.79|0.0772727272727273
29|99.0|0.035
38|263.5|0.021875
38|210.8|0.09375
51|53.0|0.0466666666666667
59|55.0|0.04



-- 3. I am doing an analysis of which shippers ship to each country, and I need a report showing the number of orders each shipper delivered to each country and the number of orders. I don't need the data where the number of orders is ten or less, but I need the report listed by country and the number of orders shipped to that country.

select shipcountry, count(orderid) as order_count, shipperid from orders group by shipperid, shipcountry having count(orderid) > 10 order by shipcountry, order_count desc;
ShipCountry|order_count|ShipperID
Austria|15|2
Austria|13|3
Austria|12|1
Brazil|35|2
Brazil|31|1
Brazil|17|3
Canada|16|3
France|29|2
France|27|1
France|21|3
Germany|53|2
Germany|41|1
Germany|28|3
Italy|14|1
Mexico|14|3
Sweden|15|2
Sweden|14|1
UK|23|2
UK|22|3
UK|11|1
USA|51|2
USA|40|3
USA|31|1
Venezuela|17|1
Venezuela|16|2
Venezuela|13|3



-- 4. For each order, what was the time lag between the order date and the ship date?

select orderdate, shippeddate, julianday(shippeddate)-julianday(orderdate) as lag from orders order by lag desc;
OrderDate|ShippedDate|lag
1997-09-08|1997-10-15|37.0
1997-12-15|1998-01-21|37.0
1996-12-12|1997-01-16|35.0
1997-01-27|1997-03-03|35.0
1997-05-22|1997-06-26|35.0
1997-07-09|1997-08-13|35.0
1998-03-04|1998-04-08|35.0
1996-09-19|1996-10-23|34.0
1997-10-15|1997-11-18|34.0
1997-10-17|1997-11-20|34.0
1998-03-05|1998-04-08|34.0
1996-11-28|1996-12-30|32.0
1997-01-23|1997-02-24|32.0
1997-02-10|1997-03-14|32.0
1997-03-24|1997-04-25|32.0
1997-07-11|1997-08-12|32.0
1997-11-03|1997-12-05|32.0
1997-11-03|1997-12-05|32.0
1997-06-24|1997-07-25|31.0
1998-03-24|1998-04-24|31.0
1996-07-24|1996-08-23|30.0
1997-04-23|1997-05-23|30.0
1997-09-30|1997-10-30|30.0
1997-12-31|1998-01-30|30.0
1996-08-01|1996-08-30|29.0
1996-08-14|1996-09-12|29.0
1996-09-10|1996-10-09|29.0
1997-02-03|1997-03-04|29.0
1997-05-01|1997-05-30|29.0
1997-11-20|1997-12-19|29.0
1997-12-16|1998-01-14|29.0
1998-01-06|1998-02-04|29.0
1997-12-22|1998-01-19|28.0
1998-01-19|1998-02-16|28.0
1998-03-26|1998-04-23|28.0
1997-04-16|1997-05-13|27.0
1997-12-24|1998-01-20|27.0
1996-09-13|1996-10-09|26.0
1997-06-13|1997-07-09|26.0
1997-10-30|1997-11-25|26.0
1997-05-19|1997-06-13|25.0
1997-06-16|1997-07-11|25.0
1998-01-12|1998-02-06|25.0
1998-01-12|1998-02-06|25.0
1998-02-06|1998-03-03|25.0
1996-12-03|1996-12-27|24.0
1997-04-22|1997-05-16|24.0
1997-10-14|1997-11-07|24.0
1997-01-07|1997-01-30|23.0
1997-05-14|1997-06-06|23.0
1997-09-10|1997-10-03|23.0
1997-09-23|1997-10-16|23.0
1997-12-10|1998-01-02|23.0
1996-11-11|1996-12-03|22.0
1998-01-13|1998-02-04|22.0
1998-03-16|1998-04-07|22.0
1998-03-30|1998-04-21|22.0
1996-12-03|1996-12-24|21.0
1997-01-24|1997-02-14|21.0
1997-02-14|1997-03-07|21.0
1997-02-19|1997-03-12|21.0
1997-03-14|1997-04-04|21.0
1997-05-02|1997-05-23|21.0
1997-07-18|1997-08-08|21.0
1998-01-09|1998-01-30|21.0
1998-03-27|1998-04-17|21.0
1997-02-19|1997-03-11|20.0
1997-03-21|1997-04-10|20.0
1997-12-25|1998-01-14|20.0
1998-02-26|1998-03-18|20.0
1998-03-19|1998-04-08|20.0
1998-04-14|1998-05-04|20.0
1996-10-04|1996-10-23|19.0
1997-04-10|1997-04-29|19.0
1997-10-03|1997-10-22|19.0
1997-10-17|1997-11-05|19.0
1998-01-22|1998-02-10|19.0
1998-02-04|1998-02-23|19.0
1998-03-20|1998-04-08|19.0
1996-07-25|1996-08-12|18.0
1997-02-10|1997-02-28|18.0
1997-11-27|1997-12-15|18.0
1998-01-30|1998-02-17|18.0
1998-03-06|1998-03-24|18.0
1997-04-15|1997-05-02|17.0
1997-06-17|1997-07-04|17.0
1997-06-27|1997-07-14|17.0
1997-09-02|1997-09-19|17.0
1998-02-13|1998-03-02|17.0
1997-01-06|1997-01-22|16.0
1996-10-03|1996-10-18|15.0
1997-01-01|1997-01-16|15.0
1997-03-03|1997-03-18|15.0
1997-12-24|1998-01-08|15.0
1998-02-02|1998-02-17|15.0
1998-03-26|1998-04-10|15.0
1997-06-10|1997-06-24|14.0
1997-08-22|1997-09-05|14.0
1997-11-28|1997-12-12|14.0
1997-12-12|1997-12-26|14.0
1998-02-20|1998-03-06|14.0
1998-04-03|1998-04-17|14.0
1996-08-29|1996-09-11|13.0
1996-11-19|1996-12-02|13.0
1998-01-28|1998-02-10|13.0
1998-03-05|1998-03-18|13.0
1998-03-06|1998-03-19|13.0
1998-04-07|1998-04-20|13.0
1998-04-15|1998-04-28|13.0
1996-07-04|1996-07-16|12.0
1996-07-11|1996-07-23|12.0
1996-10-16|1996-10-28|12.0
1996-11-13|1996-11-25|12.0
1997-01-16|1997-01-28|12.0
1997-03-28|1997-04-09|12.0
1997-04-17|1997-04-29|12.0
1997-07-25|1997-08-06|12.0
1997-08-07|1997-08-19|12.0
1997-08-20|1997-09-01|12.0
1997-08-28|1997-09-09|12.0
1997-09-18|1997-09-30|12.0
1997-11-13|1997-11-25|12.0
1998-02-20|1998-03-04|12.0
1998-02-26|1998-03-10|12.0
1998-03-06|1998-03-18|12.0
1998-03-11|1998-03-23|12.0
1998-03-27|1998-04-08|12.0
1998-04-09|1998-04-21|12.0
1996-07-19|1996-07-30|11.0
1996-08-23|1996-09-03|11.0
1996-09-27|1996-10-08|11.0
1996-11-22|1996-12-03|11.0
1997-01-10|1997-01-21|11.0
1997-01-16|1997-01-27|11.0
1997-05-08|1997-05-19|11.0
1997-06-19|1997-06-30|11.0
1997-07-18|1997-07-29|11.0
1997-09-04|1997-09-15|11.0
1997-11-10|1997-11-21|11.0
1997-12-25|1998-01-05|11.0
1998-03-19|1998-03-30|11.0
1998-04-16|1998-04-27|11.0
1996-07-19|1996-07-29|10.0
1996-08-06|1996-08-16|10.0
1996-09-23|1996-10-03|10.0
1996-09-24|1996-10-04|10.0
1996-09-30|1996-10-10|10.0
1996-10-29|1996-11-08|10.0
1996-11-22|1996-12-02|10.0
1996-12-27|1997-01-06|10.0
1996-12-30|1997-01-09|10.0
1997-01-20|1997-01-30|10.0
1997-01-27|1997-02-06|10.0
1997-02-03|1997-02-13|10.0
1997-03-04|1997-03-14|10.0
1997-04-01|1997-04-11|10.0
1997-04-18|1997-04-28|10.0
1997-04-25|1997-05-05|10.0
1997-05-05|1997-05-15|10.0
1997-05-12|1997-05-22|10.0
1997-05-19|1997-05-29|10.0
1997-05-23|1997-06-02|10.0
1997-06-03|1997-06-13|10.0
1997-06-20|1997-06-30|10.0
1997-07-04|1997-07-14|10.0
1997-08-11|1997-08-21|10.0
1997-09-01|1997-09-11|10.0
1997-09-12|1997-09-22|10.0
1997-10-03|1997-10-13|10.0
1997-10-21|1997-10-31|10.0
1997-11-04|1997-11-14|10.0
1997-11-11|1997-11-21|10.0
1997-12-05|1997-12-15|10.0
1997-12-26|1998-01-05|10.0
1997-12-26|1998-01-05|10.0
1997-12-26|1998-01-05|10.0
1997-12-30|1998-01-09|10.0
1998-01-02|1998-01-12|10.0
1998-01-13|1998-01-23|10.0
1998-02-02|1998-02-12|10.0
1998-02-09|1998-02-19|10.0
1998-02-24|1998-03-06|10.0
1998-02-27|1998-03-09|10.0
1998-03-03|1998-03-13|10.0
1998-03-06|1998-03-16|10.0
1998-03-20|1998-03-30|10.0
1998-03-23|1998-04-02|10.0
1998-03-27|1998-04-06|10.0
1998-03-31|1998-04-10|10.0
1998-04-03|1998-04-13|10.0
1998-04-06|1998-04-16|10.0
1998-04-10|1998-04-20|10.0
1998-04-14|1998-04-24|10.0
1998-04-17|1998-04-27|10.0
1998-04-24|1998-05-04|10.0
1996-07-31|1996-08-09|9.0
1996-08-21|1996-08-30|9.0
1996-09-09|1996-09-18|9.0
1996-09-25|1996-10-04|9.0
1996-10-02|1996-10-11|9.0
1996-11-11|1996-11-20|9.0
1996-11-18|1996-11-27|9.0
1996-12-10|1996-12-19|9.0
1996-12-25|1997-01-03|9.0
1996-12-25|1997-01-03|9.0
1997-01-01|1997-01-10|9.0
1997-01-15|1997-01-24|9.0
1997-01-22|1997-01-31|9.0
1997-01-29|1997-02-07|9.0
1997-02-12|1997-02-21|9.0
1997-02-18|1997-02-27|9.0
1997-03-05|1997-03-14|9.0
1997-05-21|1997-05-30|9.0
1997-05-28|1997-06-06|9.0
1997-05-28|1997-06-06|9.0
1997-06-25|1997-07-04|9.0
1997-07-01|1997-07-10|9.0
1997-07-07|1997-07-16|9.0
1997-07-22|1997-07-31|9.0
1997-07-23|1997-08-01|9.0
1997-08-05|1997-08-14|9.0
1997-08-11|1997-08-20|9.0
1997-09-02|1997-09-11|9.0
1997-09-09|1997-09-18|9.0
1997-09-10|1997-09-19|9.0
1997-09-17|1997-09-26|9.0
1997-10-27|1997-11-05|9.0
1997-11-05|1997-11-14|9.0
1997-11-18|1997-11-27|9.0
1997-11-24|1997-12-03|9.0
1997-12-01|1997-12-10|9.0
1997-12-10|1997-12-19|9.0
1997-12-16|1997-12-25|9.0
1997-12-22|1997-12-31|9.0
1997-12-23|1998-01-01|9.0
1997-12-24|1998-01-02|9.0
1998-01-05|1998-01-14|9.0
1998-01-05|1998-01-14|9.0
1998-01-07|1998-01-16|9.0
1998-01-14|1998-01-23|9.0
1998-01-20|1998-01-29|9.0
1998-01-20|1998-01-29|9.0
1998-01-21|1998-01-30|9.0
1998-01-27|1998-02-05|9.0
1998-01-28|1998-02-06|9.0
1998-02-03|1998-02-12|9.0
1998-02-04|1998-02-13|9.0
1998-02-11|1998-02-20|9.0
1998-03-02|1998-03-11|9.0
1998-03-02|1998-03-11|9.0
1998-03-04|1998-03-13|9.0
1998-03-09|1998-03-18|9.0
1998-03-09|1998-03-18|9.0
1998-03-11|1998-03-20|9.0
1998-03-16|1998-03-25|9.0
1998-03-18|1998-03-27|9.0
1998-03-18|1998-03-27|9.0
1998-03-23|1998-04-01|9.0
1998-03-24|1998-04-02|9.0
1998-03-25|1998-04-03|9.0
1998-03-25|1998-04-03|9.0
1998-04-01|1998-04-10|9.0
1998-04-15|1998-04-24|9.0
1998-04-21|1998-04-30|9.0
1998-04-22|1998-05-01|9.0
1996-07-23|1996-07-31|8.0
1996-07-29|1996-08-06|8.0
1996-08-19|1996-08-27|8.0
1996-08-27|1996-09-04|8.0
1996-09-02|1996-09-10|8.0
1996-09-03|1996-09-11|8.0
1996-09-09|1996-09-17|8.0
1996-09-17|1996-09-25|8.0
1996-10-03|1996-10-11|8.0
1996-10-15|1996-10-23|8.0
1996-11-07|1996-11-15|8.0
1996-11-26|1996-12-04|8.0
1996-11-26|1996-12-04|8.0
1996-12-23|1996-12-31|8.0
1996-12-24|1997-01-01|8.0
1996-12-26|1997-01-03|8.0
1996-12-31|1997-01-08|8.0
1997-01-02|1997-01-10|8.0
1997-01-30|1997-02-07|8.0
1997-02-06|1997-02-14|8.0
1997-03-13|1997-03-21|8.0
1997-03-13|1997-03-21|8.0
1997-03-17|1997-03-25|8.0
1997-03-18|1997-03-26|8.0
1997-03-24|1997-04-01|8.0
1997-03-31|1997-04-08|8.0
1997-04-02|1997-04-10|8.0
1997-04-03|1997-04-11|8.0
1997-04-08|1997-04-16|8.0
1997-04-09|1997-04-17|8.0
1997-05-13|1997-05-21|8.0
1997-06-05|1997-06-13|8.0
1997-07-08|1997-07-16|8.0
1997-07-21|1997-07-29|8.0
1997-08-12|1997-08-20|8.0
1997-08-12|1997-08-20|8.0
1997-08-25|1997-09-02|8.0
1997-09-03|1997-09-11|8.0
1997-09-15|1997-09-23|8.0
1997-09-30|1997-10-08|8.0
1997-10-09|1997-10-17|8.0
1997-10-13|1997-10-21|8.0
1997-10-21|1997-10-29|8.0
1997-10-28|1997-11-05|8.0
1997-11-06|1997-11-14|8.0
1997-11-20|1997-11-28|8.0
1997-12-09|1997-12-17|8.0
1997-12-16|1997-12-24|8.0
1997-12-23|1997-12-31|8.0
1997-12-30|1998-01-07|8.0
1998-01-01|1998-01-09|8.0
1998-01-08|1998-01-16|8.0
1998-01-13|1998-01-21|8.0
1998-01-15|1998-01-23|8.0
1998-01-27|1998-02-04|8.0
1998-02-03|1998-02-11|8.0
1998-02-10|1998-02-18|8.0
1998-02-12|1998-02-20|8.0
1998-02-19|1998-02-27|8.0
1998-02-23|1998-03-03|8.0
1998-02-24|1998-03-04|8.0
1998-02-26|1998-03-06|8.0
1998-03-11|1998-03-19|8.0
1998-03-16|1998-03-24|8.0
1998-04-02|1998-04-10|8.0
1998-04-06|1998-04-14|8.0
1998-04-06|1998-04-14|8.0
1998-04-07|1998-04-15|8.0
1998-04-09|1998-04-17|8.0
1998-04-23|1998-05-01|8.0
1998-04-27|1998-05-05|8.0
1996-07-08|1996-07-15|7.0
1996-07-18|1996-07-25|7.0
1996-08-05|1996-08-12|7.0
1996-08-14|1996-08-21|7.0
1996-08-16|1996-08-23|7.0
1996-08-27|1996-09-03|7.0
1996-09-06|1996-09-13|7.0
1996-09-11|1996-09-18|7.0
1996-09-16|1996-09-23|7.0
1996-09-20|1996-09-27|7.0
1996-09-26|1996-10-03|7.0
1996-10-07|1996-10-14|7.0
1996-10-18|1996-10-25|7.0
1996-10-21|1996-10-28|7.0
1996-10-28|1996-11-04|7.0
1996-10-29|1996-11-05|7.0
1996-11-04|1996-11-11|7.0
1996-11-08|1996-11-15|7.0
1996-11-20|1996-11-27|7.0
1996-12-02|1996-12-09|7.0
1996-12-18|1996-12-25|7.0
1997-01-17|1997-01-24|7.0
1997-01-28|1997-02-04|7.0
1997-01-31|1997-02-07|7.0
1997-02-05|1997-02-12|7.0
1997-02-11|1997-02-18|7.0
1997-02-13|1997-02-20|7.0
1997-02-17|1997-02-24|7.0
1997-02-24|1997-03-03|7.0
1997-03-06|1997-03-13|7.0
1997-03-11|1997-03-18|7.0
1997-03-12|1997-03-19|7.0
1997-03-17|1997-03-24|7.0
1997-03-26|1997-04-02|7.0
1997-04-02|1997-04-09|7.0
1997-04-09|1997-04-16|7.0
1997-04-11|1997-04-18|7.0
1997-04-14|1997-04-21|7.0
1997-04-15|1997-04-22|7.0
1997-04-24|1997-05-01|7.0
1997-05-16|1997-05-23|7.0
1997-05-26|1997-06-02|7.0
1997-05-29|1997-06-05|7.0
1997-06-11|1997-06-18|7.0
1997-06-18|1997-06-25|7.0
1997-06-23|1997-06-30|7.0
1997-06-23|1997-06-30|7.0
1997-07-02|1997-07-09|7.0
1997-07-02|1997-07-09|7.0
1997-07-03|1997-07-10|7.0
1997-07-07|1997-07-14|7.0
1997-07-09|1997-07-16|7.0
1997-07-11|1997-07-18|7.0
1997-07-25|1997-08-01|7.0
1997-07-30|1997-08-06|7.0
1997-08-01|1997-08-08|7.0
1997-08-19|1997-08-26|7.0
1997-08-19|1997-08-26|7.0
1997-08-20|1997-08-27|7.0
1997-08-21|1997-08-28|7.0
1997-08-25|1997-09-01|7.0
1997-08-26|1997-09-02|7.0
1997-08-27|1997-09-03|7.0
1997-08-27|1997-09-03|7.0
1997-09-01|1997-09-08|7.0
1997-09-12|1997-09-19|7.0
1997-09-15|1997-09-22|7.0
1997-09-17|1997-09-24|7.0
1997-09-22|1997-09-29|7.0
1997-09-23|1997-09-30|7.0
1997-10-07|1997-10-14|7.0
1997-10-16|1997-10-23|7.0
1997-11-04|1997-11-11|7.0
1997-11-11|1997-11-18|7.0
1997-11-17|1997-11-24|7.0
1997-11-19|1997-11-26|7.0
1997-12-02|1997-12-09|7.0
1997-12-08|1997-12-15|7.0
1997-12-19|1997-12-26|7.0
1997-12-30|1998-01-06|7.0
1998-01-06|1998-01-13|7.0
1998-01-08|1998-01-15|7.0
1998-01-16|1998-01-23|7.0
1998-01-23|1998-01-30|7.0
1998-01-23|1998-01-30|7.0
1998-01-26|1998-02-02|7.0
1998-01-27|1998-02-03|7.0
1998-02-02|1998-02-09|7.0
1998-02-11|1998-02-18|7.0
1998-02-16|1998-02-23|7.0
1998-02-16|1998-02-23|7.0
1998-02-26|1998-03-05|7.0
1998-03-04|1998-03-11|7.0
1998-03-05|1998-03-12|7.0
1998-03-11|1998-03-18|7.0
1998-03-12|1998-03-19|7.0
1998-03-16|1998-03-23|7.0
1998-03-19|1998-03-26|7.0
1998-03-23|1998-03-30|7.0
1998-04-02|1998-04-09|7.0
1998-04-03|1998-04-10|7.0
1998-04-13|1998-04-20|7.0
1998-04-14|1998-04-21|7.0
1998-04-17|1998-04-24|7.0
1998-04-20|1998-04-27|7.0
1998-04-22|1998-04-29|7.0
1998-04-24|1998-05-01|7.0
1998-04-28|1998-05-05|7.0
1996-07-10|1996-07-16|6.0
1996-07-16|1996-07-22|6.0
1996-07-17|1996-07-23|6.0
1996-08-08|1996-08-14|6.0
1996-08-15|1996-08-21|6.0
1996-08-20|1996-08-26|6.0
1996-08-22|1996-08-28|6.0
1996-08-30|1996-09-05|6.0
1996-09-04|1996-09-10|6.0
1996-09-05|1996-09-11|6.0
1996-09-18|1996-09-24|6.0
1996-09-20|1996-09-26|6.0
1996-10-31|1996-11-06|6.0
1996-11-12|1996-11-18|6.0
1996-11-14|1996-11-20|6.0
1996-12-05|1996-12-11|6.0
1996-12-17|1996-12-23|6.0
1996-12-27|1997-01-02|6.0
1997-01-03|1997-01-09|6.0
1997-01-07|1997-01-13|6.0
1997-01-08|1997-01-14|6.0
1997-01-21|1997-01-27|6.0
1997-01-21|1997-01-27|6.0
1997-02-05|1997-02-11|6.0
1997-02-20|1997-02-26|6.0
1997-02-25|1997-03-03|6.0
1997-02-26|1997-03-04|6.0
1997-03-25|1997-03-31|6.0
1997-03-27|1997-04-02|6.0
1997-04-22|1997-04-28|6.0
1997-04-30|1997-05-06|6.0
1997-05-01|1997-05-07|6.0
1997-05-20|1997-05-26|6.0
1997-05-30|1997-06-05|6.0
1997-06-04|1997-06-10|6.0
1997-06-10|1997-06-16|6.0
1997-06-12|1997-06-18|6.0
1997-06-26|1997-07-02|6.0
1997-07-15|1997-07-21|6.0
1997-07-16|1997-07-22|6.0
1997-07-24|1997-07-30|6.0
1997-08-05|1997-08-11|6.0
1997-08-08|1997-08-14|6.0
1997-08-13|1997-08-19|6.0
1997-08-15|1997-08-21|6.0
1997-09-04|1997-09-10|6.0
1997-09-09|1997-09-15|6.0
1997-09-11|1997-09-17|6.0
1997-09-25|1997-10-01|6.0
1997-10-01|1997-10-07|6.0
1997-10-01|1997-10-07|6.0
1997-10-08|1997-10-14|6.0
1997-10-08|1997-10-14|6.0
1997-10-10|1997-10-16|6.0
1997-10-14|1997-10-20|6.0
1997-10-23|1997-10-29|6.0
1997-10-29|1997-11-04|6.0
1997-10-30|1997-11-05|6.0
1997-11-12|1997-11-18|6.0
1997-11-28|1997-12-04|6.0
1997-12-02|1997-12-08|6.0
1997-12-18|1997-12-24|6.0
1998-01-01|1998-01-07|6.0
1998-01-01|1998-01-07|6.0
1998-01-02|1998-01-08|6.0
1998-01-07|1998-01-13|6.0
1998-01-15|1998-01-21|6.0
1998-01-23|1998-01-29|6.0
1998-01-29|1998-02-04|6.0
1998-02-12|1998-02-18|6.0
1998-02-19|1998-02-25|6.0
1998-02-20|1998-02-26|6.0
1998-02-25|1998-03-03|6.0
1998-02-26|1998-03-04|6.0
1998-02-26|1998-03-04|6.0
1998-03-03|1998-03-09|6.0
1998-03-03|1998-03-09|6.0
1998-03-10|1998-03-16|6.0
1998-03-12|1998-03-18|6.0
1998-03-13|1998-03-19|6.0
1998-03-27|1998-04-02|6.0
1998-03-31|1998-04-06|6.0
1998-04-01|1998-04-07|6.0
1998-04-01|1998-04-07|6.0
1998-04-16|1998-04-22|6.0
1998-04-17|1998-04-23|6.0
1998-04-17|1998-04-23|6.0
1998-04-21|1998-04-27|6.0
1998-04-22|1998-04-28|6.0
1998-04-24|1998-04-30|6.0
1998-04-30|1998-05-06|6.0
1996-07-05|1996-07-10|5.0
1996-07-26|1996-07-31|5.0
1996-08-28|1996-09-02|5.0
1996-09-12|1996-09-17|5.0
1996-10-09|1996-10-14|5.0
1996-10-16|1996-10-21|5.0
1996-10-24|1996-10-29|5.0
1996-10-30|1996-11-04|5.0
1996-11-15|1996-11-20|5.0
1996-11-21|1996-11-26|5.0
1996-11-27|1996-12-02|5.0
1996-12-04|1996-12-09|5.0
1997-01-03|1997-01-08|5.0
1997-01-09|1997-01-14|5.0
1997-01-10|1997-01-15|5.0
1997-02-14|1997-02-19|5.0
1997-02-21|1997-02-26|5.0
1997-02-28|1997-03-05|5.0
1997-03-06|1997-03-11|5.0
1997-03-07|1997-03-12|5.0
1997-03-20|1997-03-25|5.0
1997-04-11|1997-04-16|5.0
1997-04-24|1997-04-29|5.0
1997-05-14|1997-05-19|5.0
1997-06-12|1997-06-17|5.0
1997-06-26|1997-07-01|5.0
1997-07-16|1997-07-21|5.0
1997-07-17|1997-07-22|5.0
1997-07-31|1997-08-05|5.0
1997-08-06|1997-08-11|5.0
1997-08-07|1997-08-12|5.0
1997-08-14|1997-08-19|5.0
1997-08-29|1997-09-03|5.0
1997-09-05|1997-09-10|5.0
1997-09-25|1997-09-30|5.0
1997-09-26|1997-10-01|5.0
1997-10-16|1997-10-21|5.0
1997-10-22|1997-10-27|5.0
1997-10-24|1997-10-29|5.0
1997-10-31|1997-11-05|5.0
1997-11-07|1997-11-12|5.0
1997-11-12|1997-11-17|5.0
1997-11-27|1997-12-02|5.0
1997-12-03|1997-12-08|5.0
1997-12-03|1997-12-08|5.0
1997-12-04|1997-12-09|5.0
1997-12-11|1997-12-16|5.0
1997-12-17|1997-12-22|5.0
1997-12-31|1998-01-05|5.0
1998-01-07|1998-01-12|5.0
1998-01-09|1998-01-14|5.0
1998-01-14|1998-01-19|5.0
1998-01-16|1998-01-21|5.0
1998-01-21|1998-01-26|5.0
1998-01-21|1998-01-26|5.0
1998-01-29|1998-02-03|5.0
1998-02-04|1998-02-09|5.0
1998-02-05|1998-02-10|5.0
1998-02-06|1998-02-11|5.0
1998-02-18|1998-02-23|5.0
1998-03-18|1998-03-23|5.0
1998-03-26|1998-03-31|5.0
1998-04-08|1998-04-13|5.0
1998-04-10|1998-04-15|5.0
1998-04-15|1998-04-20|5.0
1996-07-08|1996-07-12|4.0
1996-08-02|1996-08-06|4.0
1996-08-09|1996-08-13|4.0
1996-08-12|1996-08-16|4.0
1996-10-10|1996-10-14|4.0
1996-10-17|1996-10-21|4.0
1996-10-25|1996-10-29|4.0
1996-11-01|1996-11-05|4.0
1996-11-28|1996-12-02|4.0
1996-12-05|1996-12-09|4.0
1996-12-09|1996-12-13|4.0
1996-12-09|1996-12-13|4.0
1996-12-16|1996-12-20|4.0
1996-12-20|1996-12-24|4.0
1997-01-23|1997-01-27|4.0
1997-01-30|1997-02-03|4.0
1997-02-21|1997-02-25|4.0
1997-03-10|1997-03-14|4.0
1997-03-20|1997-03-24|4.0
1997-04-07|1997-04-11|4.0
1997-05-08|1997-05-12|4.0
1997-05-23|1997-05-27|4.0
1997-05-30|1997-06-03|4.0
1997-06-30|1997-07-04|4.0
1997-06-30|1997-07-04|4.0
1997-07-10|1997-07-14|4.0
1997-07-14|1997-07-18|4.0
1997-07-28|1997-08-01|4.0
1997-07-31|1997-08-04|4.0
1997-08-22|1997-08-26|4.0
1997-09-19|1997-09-23|4.0
1997-09-22|1997-09-26|4.0
1997-09-26|1997-09-30|4.0
1997-09-29|1997-10-03|4.0
1997-10-06|1997-10-10|4.0
1997-10-09|1997-10-13|4.0
1997-11-14|1997-11-18|4.0
1997-11-14|1997-11-18|4.0
1997-11-17|1997-11-21|4.0
1997-11-24|1997-11-28|4.0
1997-12-05|1997-12-09|4.0
1997-12-08|1997-12-12|4.0
1997-12-18|1997-12-22|4.0
1997-12-19|1997-12-23|4.0
1997-12-22|1997-12-26|4.0
1997-12-29|1998-01-02|4.0
1998-01-05|1998-01-09|4.0
1998-01-09|1998-01-13|4.0
1998-01-15|1998-01-19|4.0
1998-01-19|1998-01-23|4.0
1998-01-26|1998-01-30|4.0
1998-01-29|1998-02-02|4.0
1998-02-05|1998-02-09|4.0
1998-03-13|1998-03-17|4.0
1998-03-19|1998-03-23|4.0
1998-03-20|1998-03-24|4.0
1998-03-30|1998-04-03|4.0
1998-04-02|1998-04-06|4.0
1998-04-09|1998-04-13|4.0
1998-04-16|1998-04-20|4.0
1998-04-20|1998-04-24|4.0
1998-04-27|1998-05-01|4.0
1998-04-30|1998-05-04|4.0
1996-07-12|1996-07-15|3.0
1996-07-22|1996-07-25|3.0
1996-07-30|1996-08-02|3.0
1996-08-13|1996-08-16|3.0
1996-10-01|1996-10-04|3.0
1996-10-11|1996-10-14|3.0
1996-10-14|1996-10-17|3.0
1996-11-05|1996-11-08|3.0
1996-11-25|1996-11-28|3.0
1996-11-29|1996-12-02|3.0
1996-12-06|1996-12-09|3.0
1996-12-13|1996-12-16|3.0
1996-12-23|1996-12-26|3.0
1997-01-14|1997-01-17|3.0
1997-02-04|1997-02-07|3.0
1997-02-07|1997-02-10|3.0
1997-02-25|1997-02-28|3.0
1997-02-28|1997-03-03|3.0
1997-03-11|1997-03-14|3.0
1997-03-31|1997-04-03|3.0
1997-04-04|1997-04-07|3.0
1997-04-04|1997-04-07|3.0
1997-04-18|1997-04-21|3.0
1997-04-21|1997-04-24|3.0
1997-04-28|1997-05-01|3.0
1997-04-29|1997-05-02|3.0
1997-05-06|1997-05-09|3.0
1997-05-09|1997-05-12|3.0
1997-05-27|1997-05-30|3.0
1997-06-03|1997-06-06|3.0
1997-06-06|1997-06-09|3.0
1997-06-06|1997-06-09|3.0
1997-06-09|1997-06-12|3.0
1997-07-22|1997-07-25|3.0
1997-07-29|1997-08-01|3.0
1997-07-29|1997-08-01|3.0
1997-08-04|1997-08-07|3.0
1997-08-15|1997-08-18|3.0
1997-08-18|1997-08-21|3.0
1997-09-05|1997-09-08|3.0
1997-10-06|1997-10-09|3.0
1997-10-20|1997-10-23|3.0
1997-10-24|1997-10-27|3.0
1997-11-07|1997-11-10|3.0
1997-11-21|1997-11-24|3.0
1997-12-15|1997-12-18|3.0
1998-01-19|1998-01-22|3.0
1998-01-30|1998-02-02|3.0
1998-02-06|1998-02-09|3.0
1998-02-09|1998-02-12|3.0
1998-02-13|1998-02-16|3.0
1998-02-23|1998-02-26|3.0
1998-02-24|1998-02-27|3.0
1998-02-27|1998-03-02|3.0
1998-02-27|1998-03-02|3.0
1998-03-09|1998-03-12|3.0
1998-03-10|1998-03-13|3.0
1998-03-10|1998-03-13|3.0
1998-03-13|1998-03-16|3.0
1998-03-17|1998-03-20|3.0
1998-03-17|1998-03-20|3.0
1998-03-17|1998-03-20|3.0
1998-03-24|1998-03-27|3.0
1998-03-30|1998-04-02|3.0
1998-04-07|1998-04-10|3.0
1998-04-10|1998-04-13|3.0
1998-04-13|1998-04-16|3.0
1998-04-28|1998-05-01|3.0
1998-05-01|1998-05-04|3.0
1998-05-01|1998-05-04|3.0
1996-07-09|1996-07-11|2.0
1996-07-15|1996-07-17|2.0
1996-08-07|1996-08-09|2.0
1996-08-26|1996-08-28|2.0
1996-10-08|1996-10-10|2.0
1996-10-22|1996-10-24|2.0
1996-10-23|1996-10-25|2.0
1996-11-06|1996-11-08|2.0
1996-12-11|1996-12-13|2.0
1996-12-16|1996-12-18|2.0
1996-12-18|1996-12-20|2.0
1997-01-13|1997-01-15|2.0
1997-01-14|1997-01-16|2.0
1997-02-12|1997-02-14|2.0
1997-03-04|1997-03-06|2.0
1997-03-19|1997-03-21|2.0
1997-03-26|1997-03-28|2.0
1997-04-29|1997-05-01|2.0
1997-05-05|1997-05-07|2.0
1997-05-07|1997-05-09|2.0
1997-05-12|1997-05-14|2.0
1997-05-21|1997-05-23|2.0
1997-06-02|1997-06-04|2.0
1997-06-17|1997-06-19|2.0
1997-09-16|1997-09-18|2.0
1997-09-24|1997-09-26|2.0
1997-10-13|1997-10-15|2.0
1997-10-22|1997-10-24|2.0
1997-10-27|1997-10-29|2.0
1997-10-29|1997-10-31|2.0
1997-11-19|1997-11-21|2.0
1997-11-25|1997-11-27|2.0
1997-11-25|1997-11-27|2.0
1997-11-26|1997-11-28|2.0
1997-12-17|1997-12-19|2.0
1997-12-29|1997-12-31|2.0
1998-02-10|1998-02-12|2.0
1998-02-10|1998-02-12|2.0
1998-02-16|1998-02-18|2.0
1998-02-17|1998-02-19|2.0
1998-02-17|1998-02-19|2.0
1998-02-18|1998-02-20|2.0
1998-02-18|1998-02-20|2.0
1998-02-25|1998-02-27|2.0
1998-03-02|1998-03-04|2.0
1998-03-03|1998-03-05|2.0
1998-03-24|1998-03-26|2.0
1998-03-25|1998-03-27|2.0
1998-03-31|1998-04-02|2.0
1998-04-01|1998-04-03|2.0
1998-04-06|1998-04-08|2.0
1998-04-08|1998-04-10|2.0
1998-04-14|1998-04-16|2.0
1998-04-20|1998-04-22|2.0
1998-04-27|1998-04-29|2.0
1998-04-29|1998-05-01|2.0
1998-05-04|1998-05-06|2.0
1998-05-04|1998-05-06|2.0
1996-08-01|1996-08-02|1.0
1996-12-12|1996-12-13|1.0
1996-12-19|1996-12-20|1.0
1997-02-27|1997-02-28|1.0
1997-05-15|1997-05-16|1.0
1997-06-19|1997-06-20|1.0
1997-08-14|1997-08-15|1.0
1997-08-28|1997-08-29|1.0
1997-09-18|1997-09-19|1.0
1997-10-02|1997-10-03|1.0
1997-11-06|1997-11-07|1.0
1997-12-11|1997-12-12|1.0
1997-12-18|1997-12-19|1.0
1998-01-22|1998-01-23|1.0
1998-02-12|1998-02-13|1.0
1998-03-12|1998-03-13|1.0
1998-04-09|1998-04-10|1.0
1998-04-23|1998-04-24|1.0
1998-04-08|NULL|
1998-04-13|NULL|
1998-04-21|NULL|
1998-04-22|NULL|
1998-04-23|NULL|
1998-04-27|NULL|
1998-04-28|NULL|
1998-04-29|NULL|
1998-04-29|NULL|
1998-04-30|NULL|
1998-04-30|NULL|
1998-05-01|NULL|
1998-05-04|NULL|
1998-05-05|NULL|
1998-05-05|NULL|
1998-05-05|NULL|
1998-05-05|NULL|
1998-05-06|NULL|
1998-05-06|NULL|
1998-05-06|NULL|
1998-05-06|NULL|



-- 5. Continuing with the previous query, I need the average time lag for each shipper.

select shipperid, avg(julianday(shippeddate)-julianday(orderdate)) as avg_lag from orders group by shipperid order by avg_lag desc;
ShipperID|avg_lag
2|9.23492063492063
1|8.57142857142857
3|7.47389558232932



-- 6. I am doing inventory, and I need to know the total price of each product on hand, that is, the price of each product line, sorted alphabetically by product name?

select productname, productid, unitsinstock, unitprice * unitsinstock as total_on_price from products order by productname;
ProductName|ProductID|UnitsInStock|total_on_price
Alice Mutton|17|0|0.0
Aniseed Syrup|3|13|130.0
Boston Crab Meat|40|123|2263.2
Camembert Pierrot|60|19|646.0
Carnarvon Tigers|18|42|2625.0
Chai|1|39|702.0
Chang|2|17|323.0
Chartreuse verte|39|69|1242.0
Chef Anton's Cajun Seasoning|4|53|1166.0
Chef Anton's Gumbo Mix|5|0|0.0
Chocolade|48|15|191.25
Côte de Blaye|38|17|4479.5
Escargots de Bourgogne|58|62|821.5
Filo Mix|52|38|266.0
Flotemysost|71|26|559.0
Geitost|33|112|280.0
Genen Shouyu|15|39|604.5
Gnocchi di nonna Alice|56|21|798.0
Gorgonzola Telino|31|0|0.0
Grandma's Boysenberry Spread|6|120|3000.0
Gravad lax|37|11|286.0
Guaraná Fantástica|24|20|90.0
Gudbrandsdalsost|69|26|936.0
Gula Malacca|44|27|525.15
Gumbär Gummibärchen|26|15|468.45
Gustaf's Knäckebröd|22|104|2184.0
Ikura|10|31|961.0
Inlagd Sill|36|112|2128.0
Ipoh Coffee|43|17|782.0
Jack's New England Clam Chowder|41|85|820.25
Konbu|13|24|144.0
Lakkalikööri|76|57|1026.0
Laughing Lumberjack Lager|67|52|728.0
Longlife Tofu|74|4|40.0
Louisiana Fiery Hot Pepper Sauce|65|76|1599.8
Louisiana Hot Spiced Okra|66|4|68.0
Manjimup Dried Apples|51|20|1060.0
Mascarpone Fabioli|32|9|288.0
Maxilaku|49|10|200.0
Mishi Kobe Niku|9|29|2813.0
Mozzarella di Giovanni|72|14|487.2
Nord-Ost Matjeshering|30|10|258.9
Northwoods Cranberry Sauce|8|6|240.0
NuNuCa Nuß-Nougat-Creme|25|76|1064.0
Original Frankfurter grüne Soße|77|32|416.0
Outback Lager|70|15|225.0
Pavlova|16|29|506.05
Perth Pasties|53|0|0.0
Pâté chinois|55|115|2760.0
Queso Cabrales|11|22|462.0
Queso Manchego La Pastora|12|86|3268.0
Raclette Courdavault|59|79|4345.0
Ravioli Angelo|57|36|702.0
Rhönbräu Klosterbier|75|125|968.75
Rogede sild|45|5|47.5
Röd Kaviar|73|101|1515.0
Rössle Sauerkraut|28|26|1185.6
Sasquatch Ale|34|111|1554.0
Schoggi Schokolade|27|49|2151.1
Scottish Longbreads|68|6|75.0
Singaporean Hokkien Fried Mee|42|26|364.0
Sir Rodney's Marmalade|20|40|3240.0
Sir Rodney's Scones|21|3|30.0
Sirop d'érable|61|113|3220.5
Spegesild|46|95|1140.0
Steeleye Stout|35|20|360.0
Tarte au sucre|62|17|838.1
Teatime Chocolate Biscuits|19|25|230.0
Thüringer Rostbratwurst|29|0|0.0
Tofu|14|35|813.75
Tourtière|54|21|156.45
Tunnbröd|23|61|549.0
Uncle Bob's Organic Dried Pears|7|15|450.0
Valkoinen suklaa|50|65|1056.25
Vegie-spread|63|24|1053.6
Wimmers gute Semmelknödel|64|22|731.5
Zaanse koeken|47|36|342.0



-- 7. What is the dollar total we have tied up in inventory?

select sum(unitprice * unitsinstock) as total from products;
total
74050.85



-- 8. We have discovered that some customers favor certain employees. I need to know this information. I need a report of the most common employee/customer pairs, the number of times the employee took orders from the customer, and trhe number of orders. Alphabetize this by customer id. Omit customer/employee pairs where the number of orders is less than five.

-- 9. How many days were in the service (if you are a veteran), or how many days will you serve (assuming you know your ETS dat)?

-- 10. Answer these questions using the built in time and date function.
--		-What is today's date?
--		-What was the first of the months?
--		-What will be the first day of the next month?
-- 		-What is the last day of this month?
